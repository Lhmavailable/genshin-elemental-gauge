<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜ç­‰å…ƒç´ è®ºæ¨¡æ‹Ÿå™¨ (è¿›é˜¶ç‰ˆ)</title>
    <style>
        :root {
            --bg: #121212;
            --panel: #1e1e1e;
            --text: #e0e0e0;
            --border: #333;
            /* å…ƒç´ è‰²è°± */
            --pyro: #FF5722;   /* ç« */
            --hydro: #03A9F4;  /* æ°´ */
            --cryo: #99FFFF;   /* å†° */
            --electro: #B388FF;/* é›· */
            --dendro: #A5D6A7; /* è‰ - MVPæš‚ä¸åšååº” */
        }

        body {
            font-family: 'Segoe UI', Consolas, sans-serif;
            background: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h1 { margin-bottom: 5px; }
        .subtitle { font-size: 0.9rem; color: #888; margin-bottom: 20px; }

        /* --- æ ¸å¿ƒæ˜¾ç¤ºåŒº --- */
        .monitor-panel {
            background: var(--panel);
            width: 100%;
            max-width: 700px;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.5);
            border: 1px solid var(--border);
            text-align: center;
            position: relative;
        }

        .element-badge {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #333;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            border: 4px solid #555;
            transition: all 0.3s;
        }

        .info-row {
            display: flex;
            justify-content: space-around;
            margin-bottom: 15px;
            font-family: 'Courier New', monospace;
        }
        .big-number { font-size: 2rem; font-weight: bold; }
        .small-label { font-size: 0.8rem; color: #888; display: block; }

        /* è¿›åº¦æ¡å®¹å™¨ */
        .progress-track {
            background: #333;
            height: 24px;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            margin: 10px 0;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.5);
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: #666;
            transition: width 0.1s linear, background-color 0.2s;
            position: relative;
        }
        
        /* åˆ»åº¦çº¿ (1.0, 2.0, 3.0 GU) */
        .tick-mark {
            position: absolute;
            top: 0; bottom: 0;
            width: 2px;
            background: rgba(255,255,255,0.2);
            z-index: 2;
        }

        /* --- æ§åˆ¶åŒº --- */
        .controls {
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* 4åˆ—å¸ƒå±€ */
            gap: 10px;
            width: 100%;
            max-width: 700px;
            margin-top: 20px;
        }

        .btn-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .group-label {
            text-align: center;
            font-weight: bold;
            font-size: 0.9rem;
            padding-bottom: 5px;
            border-bottom: 2px solid #444;
            margin-bottom: 5px;
        }

        button {
            padding: 10px 5px;
            border: none;
            border-radius: 6px;
            color: #000;
            font-weight: bold;
            font-size: 0.8rem;
            cursor: pointer;
            transition: transform 0.1s;
        }
        button:active { transform: scale(0.95); }
        
        /* æŒ‰é’®é¢œè‰² */
        .col-pyro button { background: #ffab91; }
        .col-pyro button:hover { background: var(--pyro); }
        .col-pyro .group-label { color: var(--pyro); border-color: var(--pyro); }

        .col-hydro button { background: #81d4fa; }
        .col-hydro button:hover { background: var(--hydro); }
        .col-hydro .group-label { color: var(--hydro); border-color: var(--hydro); }

        .col-cryo button { background: #e0f7fa; }
        .col-cryo button:hover { background: var(--cryo); }
        .col-cryo .group-label { color: var(--cryo); border-color: var(--cryo); }

        .col-electro button { background: #d1c4e9; }
        .col-electro button:hover { background: var(--electro); }
        .col-electro .group-label { color: var(--electro); border-color: var(--electro); }

        .global-controls {
            width: 100%; max-width: 700px;
            margin-top: 15px;
            display: flex;
            gap: 10px;
            align-items: center;
            background: #252525;
            padding: 10px;
            border-radius: 8px;
        }
        
        .btn-reset { background: #ff4444; color: white; width: 100px; }
        .btn-pause { background: #ffbb33; color: black; width: 100px; }

        /* --- æ—¥å¿—åŒº --- */
        .log-box {
            width: 100%; max-width: 700px;
            height: 200px;
            background: #000;
            border: 1px solid #444;
            border-radius: 8px;
            margin-top: 20px;
            padding: 10px;
            overflow-y: auto;
            font-family: 'Consolas', monospace;
            font-size: 0.85rem;
        }
        .log-entry { margin-bottom: 6px; border-bottom: 1px solid #222; padding-bottom: 2px; }
        .log-calc { color: #888; padding-left: 15px; display: block; font-style: italic; }
        .highlight { color: #ffff00; font-weight: bold; }

    </style>
</head>
<body>

    <h1>é«˜ç­‰å…ƒç´ è®ºæ¨¡æ‹Ÿå™¨ <span style="font-size:0.5em; vertical-align: middle; background:#333; padding:2px 6px; border-radius:4px;">v2.0 Pro</span></h1>
    <div class="subtitle">æ”¯æŒï¼šå¼±(1)/å¼º(2)/è¶…å¼º(4) Â· å…ƒç´ å åŠ åˆ·æ–° Â· å¤æ‚ååº”ç³»æ•°</div>

    <div class="monitor-panel" id="monitorPanel">
        <div class="element-badge" id="elemIcon">âšª</div>
        
        <div class="info-row">
            <div>
                <span class="small-label">å½“å‰å‰©ä½™é‡ (GU)</span>
                <span class="big-number" id="guValue">0.00</span>
            </div>
            <div>
                <span class="small-label">è¡°å‡å€’è®¡æ—¶</span>
                <span class="big-number" id="timeLeft">0.0s</span>
            </div>
        </div>

        <div class="progress-track">
            <div class="tick-mark" style="left: 25%"></div> <div class="tick-mark" style="left: 50%"></div> <div class="tick-mark" style="left: 75%"></div> <div class="progress-fill" id="progressBar"></div>
        </div>
        <div style="display:flex; justify-content:space-between; font-size:0.7rem; color:#666; padding:0 5px;">
            <span>0</span><span>1.0(å¼±)</span><span>2.0(å¼º)</span><span>3.0</span><span>4.0(è¶…)</span>
        </div>

        <div id="statusText" style="margin-top: 15px; color: #888;">ç­‰å¾…è¾“å…¥...</div>
    </div>

    <div class="global-controls">
        <button class="btn-reset" onclick="resetState()">âŒ é‡ç½®</button>
        <button class="btn-pause" onclick="togglePause()" id="pauseBtn">â¸ æš‚åœè¡°å‡</button>
        <div style="flex-grow:1; text-align:right; font-size:0.8rem; color:#888;">
            <label>æ—¶é—´æµé€Ÿ: <input type="range" min="0" max="2" step="0.1" value="1" oninput="timeScale=this.value"></label>
        </div>
    </div>

    <div class="controls">
        <div class="btn-group col-pyro">
            <div class="group-label">Pyro ç«</div>
            <button onclick="apply('Pyro', 'Weak')">å¼±ç« (1.0)</button>
            <button onclick="apply('Pyro', 'Strong')">å¼ºç« (2.0)</button>
            <button onclick="apply('Pyro', 'Super')">è¶…å¼ºç« (4.0)</button>
        </div>
        <div class="btn-group col-hydro">
            <div class="group-label">Hydro æ°´</div>
            <button onclick="apply('Hydro', 'Weak')">å¼±æ°´ (1.0)</button>
            <button onclick="apply('Hydro', 'Strong')">å¼ºæ°´ (2.0)</button>
            <button onclick="apply('Hydro', 'Super')">è¶…å¼ºæ°´ (4.0)</button>
        </div>
        <div class="btn-group col-cryo">
            <div class="group-label">Cryo å†°</div>
            <button onclick="apply('Cryo', 'Weak')">å¼±å†° (1.0)</button>
            <button onclick="apply('Cryo', 'Strong')">å¼ºå†° (2.0)</button>
            <button onclick="apply('Cryo', 'Super')">è¶…å¼ºå†° (4.0)</button>
        </div>
        <div class="btn-group col-electro">
            <div class="group-label">Electro é›·</div>
            <button onclick="apply('Electro', 'Weak')">å¼±é›· (1.0)</button>
            <button onclick="apply('Electro', 'Strong')">å¼ºé›· (2.0)</button>
            <button onclick="apply('Electro', 'Super')">è¶…å¼ºé›· (4.0)</button>
        </div>
    </div>

    <div class="log-box" id="logWindow">
        <div class="log-entry" style="color:#888">> System initialized. Ready.</div>
    </div>

<script>
        // --- 1. å¸¸é‡å®šä¹‰ (é«˜ç­‰å…ƒç´ è®ºæ ¸å¿ƒæ•°æ®) ---
        
        const GU_DATA = {
            'Weak': 1.0,
            'Strong': 2.0,
            'Super': 4.0
        };

        const DECAY_RATES = {
            'Weak': 1.0 / 9.5,
            'Strong': 2.0 / 12.0,
            'Super': 4.0 / 17.0
        };

        // ã€ä¿®æ­£ç‚¹ 1ã€‘ï¼šå°†ååº”ç³»æ•°è¡¨å‡çº§ä¸ºåŒ…å«åç§°çš„å¯¹è±¡
        const REACTION_DATA = {
            // è’¸å‘ Vaporize
            'Hydro+Pyro': { name: 'è’¸å‘ Vaporize (æ°´æ‰“ç«)', coeff: 2.0 },
            'Pyro+Hydro': { name: 'è’¸å‘ Vaporize (ç«æ‰“æ°´)', coeff: 0.5 },
            
            // èåŒ– Melt
            'Pyro+Cryo': { name: 'èåŒ– Melt (ç«æ‰“å†°)', coeff: 2.0 },
            'Cryo+Pyro': { name: 'èåŒ– Melt (å†°æ‰“ç«)', coeff: 0.5 },
            
            // å‰§å˜ååº” (ç®€åŒ–ä¸º 1:1 æ¶ˆè€—)
            'Electro+Pyro': { name: 'è¶…è½½ Overload', coeff: 1.0 },
            'Pyro+Electro': { name: 'è¶…è½½ Overload', coeff: 1.0 },
            
            'Electro+Hydro': { name: 'æ„Ÿç”µ Electro-Charged', coeff: 1.0 },
            'Hydro+Electro': { name: 'æ„Ÿç”µ Electro-Charged', coeff: 1.0 },
            
            'Electro+Cryo': { name: 'è¶…å¯¼ Superconduct', coeff: 1.0 },
            'Cryo+Electro': { name: 'è¶…å¯¼ Superconduct', coeff: 1.0 },
            
            // å†»ç»“ (æš‚åšäº’è€—)
            'Cryo+Hydro': { name: 'å†»ç»“ Frozen', coeff: 1.0 },
            'Hydro+Cryo': { name: 'å†»ç»“ Frozen', coeff: 1.0 }
        };

        const COLORS = { 
            Pyro: '#FF5722', Hydro: '#03A9F4', Cryo: '#99FFFF', Electro: '#B388FF', 
            null: '#333' 
        };
        const ICONS = { Pyro: 'ğŸ”¥', Hydro: 'ğŸ’§', Cryo: 'â„ï¸', Electro: 'âš¡', null: 'âšª' };

        // --- 2. çŠ¶æ€ç®¡ç† ---
        
        let state = {
            element: null,     
            gauge: 0.0,         
            decayRate: 0.0,    
            lastTime: Date.now(),
            isPaused: false
        };
        
        let timeScale = 1.0; 

        // --- 3. æ ¸å¿ƒé€»è¾‘ ---

        function apply(incomingElem, strengthType) {
            const incomingGauge = GU_DATA[strengthType];
            const incomingDecayRate = DECAY_RATES[strengthType];
            
            addLog(`æ“ä½œ: æ–½åŠ  [${strengthType} ${incomingElem}] (${incomingGauge.toFixed(1)} GU)`);

            if (state.element === null) {
                state.element = incomingElem;
                state.gauge = incomingGauge;
                state.decayRate = incomingDecayRate;
                addLog(`>>> é™„ç€æˆåŠŸã€‚åˆå§‹é€Ÿç‡: ${state.decayRate.toFixed(3)} GU/s`);
            }
            
            else if (state.element === incomingElem) {
                if (incomingGauge > state.gauge) {
                    addLog(`>>> åŒè‰²åˆ·æ–°: æ–°é‡(${incomingGauge}) > æ—§é‡(${state.gauge.toFixed(2)})`);
                    state.gauge = incomingGauge;
                    state.decayRate = incomingDecayRate;
                } else {
                    addLog(`>>> åŒè‰²è¡¥å……: æ–°é‡(${incomingGauge}) < æ—§é‡ï¼Œä»…åˆ·æ–°æŒç»­æ—¶é—´`);
                    state.gauge = Math.max(state.gauge, incomingGauge);
                }
            }
            
            // ã€ä¿®æ­£ç‚¹ 2ã€‘ï¼šè¯»å–æ–°çš„æ•°æ®ç»“æ„
            else {
                const key = `${incomingElem}+${state.element}`;
                const reactionInfo = REACTION_DATA[key]; // è·å–ååº”å¯¹è±¡
                
                if (reactionInfo) {
                    const { name, coeff } = reactionInfo; // è§£æ„å‡ºåå­—å’Œç³»æ•°
                    const cost = incomingGauge * coeff;
                    
                    // ã€ä¿®æ­£ç‚¹ 3ã€‘ï¼šæ—¥å¿—ä¸­æ˜¾ç¤ºå…·ä½“çš„ååº”åç§°
                    addLog(`<span class="highlight">>>> è§¦å‘: [${name}] (ç³»æ•° ${coeff})</span>`);
                    addLog(`è®¡ç®—: åº•è‰²(${state.gauge.toFixed(2)}) - (æ”»å‡»${incomingGauge} * ç³»æ•°${coeff})`);
                    
                    state.gauge -= cost;
                    
                    if (state.gauge <= 0) {
                        state.gauge = 0;
                        state.element = null;
                        state.decayRate = 0;
                        addLog(`ç»“æœ: å…ƒç´ è¢«å®Œå…¨æ¶ˆè€—ï¼Œæ— æ®‹ç•™ã€‚`);
                    } else {
                        addLog(`ç»“æœ: ååº”åæœ‰æ®‹ç•™ ${state.gauge.toFixed(2)} GU`);
                    }
                } else {
                    addLog(`æœªå®šä¹‰æˆ–ä¸å‘ç”Ÿååº”çš„ç»„åˆã€‚`);
                }
            }
            updateUI();
        }

        function gameLoop() {
            const now = Date.now();
            const dt = (now - state.lastTime) / 1000 * timeScale;
            state.lastTime = now;

            if (!state.isPaused && state.gauge > 0) {
                state.gauge -= dt * state.decayRate;
                if (state.gauge <= 0) {
                    state.gauge = 0;
                    state.element = null;
                    state.decayRate = 0;
                    addLog(`[System] å…ƒç´ å·²éšæ—¶é—´è‡ªç„¶æ¶ˆæ•£ã€‚`);
                }
                updateUI();
            }
            requestAnimationFrame(gameLoop);
        }

        function updateUI() {
            const bar = document.getElementById('progressBar');
            const guText = document.getElementById('guValue');
            const timeText = document.getElementById('timeLeft');
            const icon = document.getElementById('elemIcon');
            const status = document.getElementById('statusText');
            const panel = document.getElementById('monitorPanel');

            guText.innerText = state.gauge.toFixed(2);
            
            let timeLeft = 0;
            if (state.decayRate > 0) {
                timeLeft = state.gauge / state.decayRate;
            }
            timeText.innerText = timeLeft.toFixed(1) + 's';

            icon.innerText = ICONS[state.element];
            icon.style.borderColor = COLORS[state.element];
            icon.style.boxShadow = state.element ? `0 0 20px ${COLORS[state.element]}` : 'none';

            const maxScale = 4.0; 
            const pct = (state.gauge / maxScale) * 100;
            bar.style.width = pct + '%';
            bar.style.backgroundColor = COLORS[state.element] || '#666';

            if (state.element) {
                status.innerText = `çŠ¶æ€: [${state.element}] é™„ç€ä¸­ | è¡°å‡é€Ÿç‡: ${state.decayRate.toFixed(3)}/s`;
                status.style.color = COLORS[state.element];
            } else {
                status.innerText = "æ— é™„ç€";
                status.style.color = "#888";
            }
        }

        function resetState() {
            state.element = null;
            state.gauge = 0;
            state.decayRate = 0;
            addLog("--- çŠ¶æ€å·²é‡ç½® ---");
            updateUI();
        }

        function togglePause() {
            state.isPaused = !state.isPaused;
            document.getElementById('pauseBtn').innerText = state.isPaused ? "â–¶ ç»§ç»­" : "â¸ æš‚åœè¡°å‡";
            addLog(state.isPaused ? "[System] è¡°å‡æš‚åœ" : "[System] è¡°å‡ç»§ç»­");
        }

        function addLog(msg) {
            const box = document.getElementById('logWindow');
            const time = new Date().toLocaleTimeString().split(' ')[0];
            const div = document.createElement('div');
            div.className = 'log-entry';
            
            if (msg.includes('è®¡ç®—:')) {
                const parts = msg.split('è®¡ç®—:');
                div.innerHTML = `<span style="color:#666">[${time}]</span> ${parts[0]}<br><span class="log-calc">Calculation: ${parts[1]}</span>`;
            } else {
                div.innerHTML = `<span style="color:#666">[${time}]</span> ${msg}`;
            }
            
            box.appendChild(div);
            box.scrollTop = box.scrollHeight;
        }

        gameLoop();
    </script></body>
</html>